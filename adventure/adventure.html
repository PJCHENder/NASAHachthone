<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Start Adventure</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://unpkg.com/bootstrap@3.3.7/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="../styles/index.processed.css">
    <style>
    #app {
        width: 100%;
        height: 100%;
    }
    
    .header {
        padding: 100px 50px 200px;
        background-image: url('../img/bg_weather.jpg');
        position: relative;
        width: 100%;
        height: 100%;
    }
    
    .flex-box-container {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        height: 100%;
    }
    
    .flex-box-item {
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        border-radius: 15px;
    }
    
    .flex-box-item h3,
    .flex-box-item p {
        color: rgb(255, 255, 255);
        padding: 60px;
    }
    
    .panel-custom {
        padding-top: 50px;
    }
    
    .showBox {
        width: 100%;
        height: 40%;
    }
    </style>
</head>

<body>
    <div id="app">
        <!-- Navigation-->
        <a class="btn btn-dark btn-lg toggle" id="menu-toggle" href="#"><i class="fa fa-bars"></i></a>
        <nav id="sidebar-wrapper">
            <ul class="sidebar-nav"><a class="btn btn-light btn-lg pull-right toggle" id="menu-close" href="#"><i class="fa fa-times"></i></a>
                <li class="sidebar-brand"><a href="#top">Start Trips</a></li>
                <li><a href="#top">Adventure</a></li>
                <li><a href="#about">Help</a></li>
            </ul>
        </nav>
        <!-- Header-->
        <header class="header" id="top">
            <div class="flex-box-container">
                <div class="flex-box-item play-block">
                    <h3>衛星名稱</h3>
                    <div class='showBox'>
                    </div>
                </div>
            </div>
            <div class="panel-custom col-md-8 col-md-offset-2">
                <div class="btn-group btn-group-justified" role="group" aria-label="...">
                    <a class="first-btn select btn btn-dark btn-lg" id="backward">前往上一站</a>
                    <a class="select btn btn-dark btn-lg" id="pause" href="#" data-toggle="modal" data-target="#myModal" 
                    >暫停</a>
                    <a class="select btn btn-dark btn-lg" id="look-earth" href="#" data-toggle="modal" data-target="#myModal" 
                    >播放</a>
                    <a class="select btn btn-dark btn-lg" id="next-step" href="#">前往下一站</a>
                </div>
            </div>
        </header>
        <!-- modal -->
        <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        <h4 class="modal-title" id="myModalLabel"> 城市 </h4>
                    </div>
                    <div class="modal-body" style="text-align:center">
                        <img style="width: 100%; height: auto" :src="imgSrc">
                    </div>
                </div>
            </div>
        </div>
        <!-- audio -->
        <audio id="audio" :src="audioSrc"></audio>
    </div>
    <script src="https://unpkg.com/vue@2.3.0/dist/vue.js"></script>
    <script src="https://unpkg.com/jquery@3.2.1/dist/jquery.min.js"></script>
    <script src="https://unpkg.com/bootstrap@3.3.7/dist/js/bootstrap.min.js"></script>
    <script>
    /* eslint-disable */
    const vm = new Vue({
        el: '#app',
        data: {
            stopPoints: {},
            currentStop: 0
        },
        computed: {
            // city() {
            //     return this.stops[this.currentStop].city
            // },
            // imgSrc() {
            //     return this.stops[this.currentStop].imgSrc
            // },
            // audioSrc() {
            //     let url = `http://api.voicerss.org/?key=b9ee185dd0394b7aa4e062e891e28b15&hl=zh-tw&r=6&src=${this.stops[this.currentStop].speechContent}`
            //     return url
            // }
        },
        methods: {
            // playAudio(event) {
            //     console.log('playAudio')
            //     document.getElementById('audio').play()
            // },
            // nextStop() {
            //     console.log('receive nextStop')
            //     this.currentStop += 1
            // },
            // spaceHandler() {
            //     $('#look-earth').trigger('click')
            // }
        },
        created() {

            const vm = this
            const today = new Date()

            // Selected day to show on the map
            let day = new Date(today.getTime())

            function dayParameter() {
                return day.toISOString().split("T")[0];
            }

            let request = $.ajax({
                "async": true,
                "crossDomain": true,
                method: "GET",
                url: 'http://10.20.12.205:8000',
                data: {
                    satellite: 'TERRA',
                    time: dayParameter()
                }
            })
            request.done(function(res) {
                for (let prop in res) {
                  vm.stopPoints[prop] = res[prop]
                }
                console.log('requst Successfully')
            })
            request.fail(function(jqXHR, textStatus) {
                console.log("Request failed: ", jqXHR)
                console.log('Failed', textStatus)
            })
        },
        mounted() {
            let vm = this
            document.addEventListener('keydown', function(e) {
                e.preventDefault()
            })
            document.addEventListener('keyup', function(e) {
                e.preventDefault()
                console.log(e.keyCode)

                if (e.keyCode === 32) {
                    // Space
                    vm.spaceHandler()
                } else if (e.keyCode === 39) {
                    // Right 
                    console.log('emit nextStop')
                    vm.nextStop()
                } else {
                    console.log('請按空白鍵來觀看地球；按向上鍵來前往下一站')
                }
            })
        }
    })
    </script>
</body>

</html>
